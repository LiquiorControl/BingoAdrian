<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Adri√°n (v3.1 Voz Argentina)</title>
    <!-- React y Dependencias -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Animaciones y Efectos Personalizados */
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap');
        
        body { font-family: 'Montserrat', sans-serif; }
        
        @keyframes bounce-short { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-15px) scale(1.05); } }
        .animate-bounce-short { animation: bounce-short 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        
        /* Bola 3D */
        .ball-3d {
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.1) 20%, transparent 60%),
                        radial-gradient(circle at 50% 50%, var(--ball-color) 0%, #000 100%);
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.5), inset 0 0 20px rgba(0,0,0,0.5);
        }

        /* Efecto Neon */
        .neon-text { text-shadow: 0 0 10px currentColor; }
        .neon-box { box-shadow: 0 0 15px var(--glow-color); border-color: var(--glow-color) !important; }

        @media print { @page { size: A4; margin: 10mm; } body { background: white; } .no-print { display: none !important; } }
        
        /* Scrollbar bonito */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.4); }

        #loading-screen { position: fixed; inset: 0; background: #0f172a; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { width: 50px; height: 50px; border: 4px solid rgba(255,255,255,0.1); border-top-color: #ec4899; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-[#0f172a] text-white overflow-x-hidden min-h-screen relative selection:bg-pink-500 selection:text-white">

    <!-- Fondo ambiental -->
    <div class="fixed inset-0 z-0 pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-purple-600/20 rounded-full blur-[120px]"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/20 rounded-full blur-[120px]"></div>
    </div>

    <div id="loading-screen">
        <div class="spinner mb-6"></div>
        <h2 class="text-2xl font-black tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-violet-500">ADRI√ÅN BINGO</h2>
        <p class="text-slate-500 text-sm mt-2 font-bold">CARGANDO...</p>
    </div>
    <div id="root" class="relative z-10"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        const APP_VERSION = "v3.1"; 

        // --- ICONOS ---
        const Icon = ({ p, size=24, cls="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={cls}>{p}</svg>;
        const Play = (p) => <Icon p={<polygon points="5 3 19 12 5 21 5 3" />} {...p}/>;
        const Pause = (p) => <Icon p={<g><rect x="6" y="4" width="4" height="16" /><rect x="14" y="4" width="4" height="16" /></g>} {...p}/>;
        const RotateCcw = (p) => <Icon p={<g><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /><path d="M3 3v5h5" /></g>} {...p}/>;
        const Volume2 = (p) => <Icon p={<g><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><path d="M19.07 4.93a10 10 0 0 1 0 14.14" /><path d="M15.54 8.46a5 5 0 0 1 0 7.07" /></g>} {...p}/>;
        const VolumeX = (p) => <Icon p={<g><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><line x1="23" y1="9" x2="17" y2="15" /><line x1="17" y1="9" x2="23" y2="15" /></g>} {...p}/>;
        const MusicNote = (p) => <Icon p={<g><path d="M9 18V5l12-2v13" /><circle cx="6" cy="18" r="3" /><circle cx="18" cy="16" r="3" /></g>} {...p}/>;
        const MusicOff = (p) => <Icon p={<g><path d="M9 18V5l12-2v13" /><circle cx="6" cy="18" r="3" /><circle cx="18" cy="16" r="3" /><line x1="2" y1="2" x2="22" y2="22" /></g>} {...p}/>;
        const ChevronRight = (p) => <Icon p={<polyline points="9 18 15 12 9 6" />} {...p}/>;
        const Settings = (p) => <Icon p={<g><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></g>} {...p}/>;
        const CheckCircle = (p) => <Icon p={<g><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /><polyline points="22 4 12 14.01 9 11.01" /></g>} {...p}/>;
        const X = (p) => <Icon p={<g><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></g>} {...p}/>;
        const Smartphone = (p) => <Icon p={<g><rect x="5" y="2" width="14" height="20" rx="2" ry="2" /><line x1="12" y1="18" x2="12.01" y2="18" /></g>} {...p}/>;
        const FileText = (p) => <Icon p={<g><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></g>} {...p}/>;
        const Wand2 = (p) => <Icon p={<g><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z"/><path d="m14 7 3 3"/><path d="M5 6v4"/><path d="M19 14v4"/><path d="M10 2v2"/><path d="M7 8H3"/><path d="M21 16h-4"/><circle cx="11" cy="11" r="8" opacity="0"/></g>} {...p}/>;
        const Palette = (p) => <Icon p={<g><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></g>} {...p}/>;

        // --- TEMAS (Actualizados con degradados) ---
        const THEMES = {
            blue:   { name: "Azul",   grad: "from-blue-600 to-indigo-600", accent: "text-blue-400", glow: "#3b82f6", border: "border-blue-500/30" },
            red:    { name: "Rojo",   grad: "from-red-600 to-pink-600",    accent: "text-red-400",  glow: "#ef4444", border: "border-red-500/30" },
            green:  { name: "Verde",  grad: "from-emerald-500 to-teal-600",accent: "text-emerald-400", glow: "#10b981", border: "border-emerald-500/30" },
            purple: { name: "Morado", grad: "from-violet-600 to-purple-600",accent: "text-violet-400", glow: "#8b5cf6", border: "border-violet-500/30" },
            orange: { name: "Naranja",grad: "from-orange-500 to-amber-600",accent: "text-orange-400", glow: "#f97316", border: "border-orange-500/30" },
            pink:   { name: "Rosa",   grad: "from-pink-500 to-rose-600",   accent: "text-pink-400",   glow: "#ec4899", border: "border-pink-500/30" },
        };

        const mulberry32 = (a) => () => { let t = a += 0x6D2B79F5; t = Math.imul(t ^ (t >>> 15), t | 1); t ^= t + Math.imul(t ^ (t >>> 7), t | 61); return ((t ^ (t >>> 14)) >>> 0) / 4294967296; };
        const generateCardData = (sn) => {
            const rng = mulberry32(sn);
            const ranges = [[1,9],[10,19],[20,29],[30,39],[40,49],[50,59],[60,69],[70,79],[80,90]];
            let rows = [[],[],[]], colsArr = Array(9).fill(0).map(()=>[]);
            for(let c=0; c<9; c++) {
                let [min,max] = ranges[c];
                let nums = new Set();
                while(nums.size < 3) nums.add(Math.floor(rng()*(max-min+1))+min);
                let sorted = [...nums].sort((a,b)=>a-b);
                colsArr[c] = sorted; 
            }
            const grid = Array(3).fill(null).map(()=>Array(9).fill(0));
            const rowConfigs = [];
            for(let r=0; r<3; r++) {
                let cols=[0,1,2,3,4,5,6,7,8];
                for(let i=8; i>0; i--) { const j=Math.floor(rng()*(i+1)); [cols[i],cols[j]]=[cols[j],cols[i]]; }
                rowConfigs.push(cols.slice(0,5).sort((a,b)=>a-b));
            }
            const colNums = Array(9).fill(null).map(()=>[]);
            for(let r=0; r<3; r++) {
                rowConfigs[r].forEach(cIdx => {
                    const [min,max] = ranges[cIdx];
                    let n; do { n=Math.floor(rng()*(max-min+1))+min; } while(colNums[cIdx].includes(n));
                    colNums[cIdx].push(n); colNums[cIdx].sort((a,b)=>a-b);
                });
            }
            for(let c=0; c<9; c++) {
                const nums = colNums[c];
                const activeRows = [0,1,2].filter(r => rowConfigs[r].includes(c));
                activeRows.forEach((r,i) => { if(nums[i]) grid[r][c] = nums[i]; });
            }
            return grid;
        };

        const BingoApp = () => {
            const TOTAL_NUMBERS = 90;
            const [drawnNumbers, setDrawnNumbers] = useState([]);
            const [currentNumber, setCurrentNumber] = useState(null);
            const [isAutoPlaying, setIsAutoPlaying] = useState(false);
            const [gameSpeed, setGameSpeed] = useState(3000);
            const [soundEnabled, setSoundEnabled] = useState(true);
            const [musicEnabled, setMusicEnabled] = useState(false);
            const [gameOver, setGameOver] = useState(false);
            const [showTools, setShowTools] = useState(false);
            const [toolTab, setToolTab] = useState('check');
            const [checkSerial, setCheckSerial] = useState('');
            const [checkResult, setCheckResult] = useState(null);
            const [printSerialStart, setPrintSerialStart] = useState(1000);
            const [printCount, setPrintCount] = useState(4);
            const [generatedCards, setGeneratedCards] = useState([]);
            const [theme, setTheme] = useState("blue");
            const [showMagic, setShowMagic] = useState(false);
            const [magicCode, setMagicCode] = useState("");
            const [isMagicAuthenticated, setIsMagicAuthenticated] = useState(false);
            const [magicSerial, setMagicSerial] = useState("");
            const [magicEnabled, setMagicEnabled] = useState(false);
            const [magicClicks, setMagicClicks] = useState(0); 
            const [voices, setVoices] = useState([]); // Nueva variable para guardar las voces disponibles

            const autoPlayRef = useRef(null);
            const audioRef = useRef(null);
            const MUSIC_URL = "https://commondatastorage.googleapis.com/codeskulptor-assets/Epoq-Lepidoptera.ogg";

            const T = THEMES[theme];

            // Cargar voces cuando est√©n disponibles
            useEffect(() => {
                const loadVoices = () => {
                    const available = window.speechSynthesis.getVoices();
                    setVoices(available);
                };
                
                loadVoices();
                // Algunos navegadores cargan las voces de forma as√≠ncrona
                if (window.speechSynthesis.onvoiceschanged !== undefined) {
                    window.speechSynthesis.onvoiceschanged = loadVoices;
                }
                
                document.getElementById('loading-screen').style.display = 'none';
            }, []);

            useEffect(() => {
                if (isAutoPlaying && !gameOver) autoPlayRef.current = setInterval(drawBall, gameSpeed);
                else clearInterval(autoPlayRef.current);
                return () => clearInterval(autoPlayRef.current);
            }, [isAutoPlaying, drawnNumbers, gameSpeed, gameOver]);

            useEffect(() => {
                if (audioRef.current) {
                    audioRef.current.volume = 0.5;
                    if (musicEnabled) audioRef.current.play().catch(e => console.log("Click para audio"));
                    else audioRef.current.pause();
                }
            }, [musicEnabled]);

            const toggleMusic = () => {
                const newState = !musicEnabled;
                setMusicEnabled(newState);
                if (audioRef.current) {
                    if (newState) {
                        audioRef.current.volume = 0.5;
                        audioRef.current.play().catch(e=>{});
                    } else { audioRef.current.pause(); }
                }
            };

            const drawBall = () => {
                if (drawnNumbers.length >= TOTAL_NUMBERS) { setGameOver(true); setIsAutoPlaying(false); speak("Fin del juego"); return; }
                let n;
                let usedMagic = false;
                if (magicEnabled && magicSerial) {
                    const s = parseInt(magicSerial);
                    if (s) {
                        const magicGrid = generateCardData(s);
                        const neededNumbers = magicGrid.flat().filter(num => num !== 0 && !drawnNumbers.includes(num));
                        if (neededNumbers.length > 0 && Math.random() < 0.5) {
                            const randomIndex = Math.floor(Math.random() * neededNumbers.length);
                            n = neededNumbers[randomIndex];
                            usedMagic = true;
                        }
                    }
                }
                if (!usedMagic) {
                    do { n = Math.floor(Math.random() * TOTAL_NUMBERS) + 1; } while (drawnNumbers.includes(n));
                }
                setDrawnNumbers(p => [...p, n]); setCurrentNumber(n); speak(n);
            };

            const resetGame = () => { setIsAutoPlaying(false); setDrawnNumbers([]); setCurrentNumber(null); setGameOver(false); setCheckResult(null); speak("Reinicio"); };
            
            // Funci√≥n auxiliar para encontrar la mejor voz
            const getBestVoice = (langCode) => {
                if (voices.length === 0) return null;
                
                if (langCode === 'es') {
                    // Prioridad 1: Argentina
                    const arVoice = voices.find(v => v.lang === 'es-AR');
                    if (arVoice) return arVoice;
                    
                    // Prioridad 2: M√©xico / Latinoam√©rica (suena m√°s cercano a AR que a ES)
                    const latVoice = voices.find(v => ['es-MX', 'es-US', 'es-419'].includes(v.lang));
                    if (latVoice) return latVoice;
                    
                    // Prioridad 3: Cualquier espa√±ol
                    return voices.find(v => v.lang.startsWith('es'));
                }
                return voices.find(v => v.lang.startsWith('en'));
            };

            const speak = (txt) => {
                if (!soundEnabled || !window.speechSynthesis) return;
                window.speechSynthesis.cancel();
                
                const u1 = new SpeechSynthesisUtterance(txt.toString());
                const esVoice = getBestVoice('es');
                if (esVoice) u1.voice = esVoice;
                u1.lang = esVoice ? esVoice.lang : 'es-AR'; // Fallback forzoso
                window.speechSynthesis.speak(u1);
                
                if (typeof txt === 'number') { 
                    const u2 = new SpeechSynthesisUtterance(txt.toString());
                    const enVoice = getBestVoice('en');
                    if (enVoice) u2.voice = enVoice;
                    u2.lang = 'en-US'; 
                    window.speechSynthesis.speak(u2); 
                }
            };

            const handleCheckCard = () => {
                const s = parseInt(checkSerial); if(!s) return;
                const g = generateCardData(s);
                let rowsRes = [], total=0;
                g.forEach(r => {
                    const matches = r.filter(n=>n!==0 && drawnNumbers.includes(n)).length;
                    total += matches;
                    rowsRes.push({ m: matches, s: matches===5?'L√≠nea':matches===3?'Terna':'Nada' });
                });
                let prize = total===15 ? "¬°BINGO!" : rowsRes.some(r=>r.s==='L√≠nea') ? "¬°L√çNEA!" : rowsRes.some(r=>r.s==='Terna') ? "¬°TERNA!" : "Sin Premio";
                setCheckResult({ s, grid: g, analysis: { rows: rowsRes, mainPrize: prize } });
            };

            const handlePrint = () => {
                const cards=[]; for(let i=0; i<printCount; i++) cards.push({s:parseInt(printSerialStart)+i, g:generateCardData(parseInt(printSerialStart)+i)});
                setGeneratedCards(cards);
            };
            const openPrintWindow = () => {
                const chunks=[]; for(let i=0; i<generatedCards.length; i+=3) chunks.push(generatedCards.slice(i,i+3));
                const w = window.open('','_blank');
                w.document.write(`<html><head><title>Cartones</title><style>@page{size:A4;margin:10mm}body{font-family:sans-serif}.page{height:270mm;display:flex;flex-direction:column;justify-content:space-between;page-break-after:always;padding:10px;box-sizing:border-box}.page:last-child{page-break-after:auto}.card{border:3px solid #000;padding:15px;border-radius:12px}.head{display:flex;justify-content:space-between;margin-bottom:10px;font-weight:bold;border-bottom:2px solid #eee}.grid{display:grid;grid-template-columns:repeat(9,1fr);gap:0;border:2px solid #000}.cell{border:1px solid #000;height:60px;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:800}.empty{background:#f0f0f0}@media print{.no-print{display:none}}</style></head><body><div class="no-print" style="text-align:center;padding:20px"><button onclick="window.print()" style="padding:10px 20px;background:#2563eb;color:white;border:none;border-radius:5px;cursor:pointer">üñ®Ô∏è Imprimir PDF</button></div>${chunks.map(ch=>`<div class="page">${ch.map(c=>`<div class="card"><div class="head"><span style="color:#dc2626">BINGO ADRI√ÅN</span><span>Serie #${c.s}</span></div><div class="grid">${c.g.flat().map(n=>`<div class="cell ${n===0?'empty':''}">${n||''}</div>`).join('')}</div></div>`).join('')}</div>`).join('')}</body></html>`);
                w.document.close();
            };

            const getBallColor = (n) => {
                if(n<=10) return "#ef4444"; // Red
                if(n<=20) return "#f97316"; // Orange
                if(n<=30) return "#f59e0b"; // Amber
                if(n<=40) return "#84cc16"; // Lime
                if(n<=50) return "#10b981"; // Green
                if(n<=60) return "#14b8a6"; // Teal
                if(n<=70) return "#3b82f6"; // Blue
                if(n<=80) return "#6366f1"; // Indigo
                return "#ec4899"; // Pink
            };

            const handleMagicLogin = () => {
                if (magicCode === "0313") {
                    setIsMagicAuthenticated(true);
                } else {
                    alert("C√≥digo incorrecto");
                }
            };

            return (
                <div className="min-h-screen p-4 font-sans relative">
                    <audio ref={audioRef} src={MUSIC_URL} loop />

                    <div className="max-w-7xl mx-auto">
                        <div className="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4">
                            <h1 className="text-4xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-400 drop-shadow-lg">
                                BINGO <span className={`bg-clip-text text-transparent bg-gradient-to-r ${T.grad}`}>ADRI√ÅN</span>
                            </h1>
                            <a href="mobile.html" className="flex items-center gap-2 bg-slate-800/50 backdrop-blur-md text-white px-5 py-2.5 rounded-2xl hover:bg-slate-700/50 transition border border-white/10 shadow-lg group">
                                <Smartphone size={20} className="text-slate-400 group-hover:text-white transition"/> <span className="text-sm font-bold tracking-wide">M√ìVIL</span>
                            </a>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                            
                            {/* PANEL IZQUIERDO: CONTROLES */}
                            <div className="lg:col-span-4 flex flex-col items-center bg-slate-800/40 backdrop-blur-xl p-8 rounded-[2rem] shadow-2xl border border-white/5 sticky top-4 h-fit z-10">
                                <div className="w-full flex justify-between text-xs font-bold tracking-wider text-slate-400 mb-6 uppercase">
                                    <span>Bolas: <span className="text-white text-base">{drawnNumbers.length}</span> / 90</span>
                                    <span>{currentNumber ? '√öLTIMA' : 'ESPERANDO'}</span>
                                </div>
                                
                                <div className="my-2 flex flex-col items-center justify-center min-h-[200px] w-full relative">
                                    <div 
                                        className={`w-48 h-48 rounded-full flex items-center justify-center transition-all duration-500 relative z-10 ${currentNumber ? 'ball-3d animate-bounce-short' : 'bg-slate-700/50 border-4 border-slate-600/30'}`}
                                        style={currentNumber ? {'--ball-color': getBallColor(currentNumber)} : {}}
                                    >
                                        <span className="text-8xl font-black text-white drop-shadow-md tracking-tighter">
                                            {currentNumber||"--"}
                                        </span>
                                    </div>
                                    
                                    {/* Sombra de la bola */}
                                    <div className="w-32 h-4 bg-black/40 blur-xl rounded-[100%] absolute bottom-2 transition-all duration-500" style={{transform: currentNumber ? 'scale(1)' : 'scale(0.8)', opacity: currentNumber ? 0.6 : 0.2 }}></div>

                                    {/* √öltimas bolas */}
                                    <div className="flex gap-3 mt-8 overflow-hidden p-2 justify-center w-full mask-linear">
                                        {drawnNumbers.slice(0,-1).slice(-5).reverse().map((n,i)=> (
                                            <div key={i} 
                                                className="w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg text-white shadow-lg border border-white/10"
                                                style={{background: getBallColor(n)}}
                                            >
                                                {n}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="w-full space-y-4 mt-6">
                                    <div className="grid grid-cols-2 gap-4">
                                        <button onClick={()=>setIsAutoPlaying(!isAutoPlaying)} className={`flex items-center justify-center gap-2 py-4 rounded-2xl font-bold text-white shadow-lg transition-all active:scale-95 bg-gradient-to-br ${isAutoPlaying ? 'from-orange-500 to-red-500 shadow-orange-900/20' : `${T.grad} shadow-lg`} hover:brightness-110`}>
                                            {isAutoPlaying?<><Pause/> PAUSAR</>:<><Play/> AUTO</>}
                                        </button>
                                        <button onClick={drawBall} disabled={isAutoPlaying} className="flex items-center justify-center gap-2 py-4 rounded-2xl font-bold bg-gradient-to-br from-emerald-500 to-teal-600 text-white shadow-lg shadow-emerald-900/20 transition-all active:scale-95 disabled:opacity-50 hover:brightness-110">
                                            SACAR <ChevronRight/>
                                        </button>
                                    </div>
                                    
                                    <div className="grid grid-cols-4 gap-2">
                                        <button onClick={resetGame} className="col-span-2 flex items-center justify-center gap-2 py-3 rounded-xl font-bold bg-slate-700/50 hover:bg-slate-600/50 text-slate-300 transition backdrop-blur-sm border border-white/5">
                                            <RotateCcw size={18}/> Reiniciar
                                        </button>
                                        <button onClick={()=>setShowTools(true)} className={`col-span-1 flex items-center justify-center rounded-xl font-bold bg-gradient-to-br ${T.grad} text-white shadow-lg hover:scale-105 transition`} title="Cartones">
                                            <FileText size={20}/>
                                        </button>
                                        <button onClick={()=>setShowMagic(true)} className="col-span-1 flex items-center justify-center rounded-xl font-bold bg-slate-700/50 text-slate-400 hover:text-white hover:bg-slate-600/50 transition border border-white/5" title="Ajustes">
                                            <Settings size={20}/>
                                        </button>
                                    </div>
                                </div>

                                {/* Controles de Audio y Velocidad */}
                                <div className="mt-8 w-full pt-6 border-t border-white/10">
                                    <div className="flex gap-3 mb-6">
                                        <button onClick={()=>setSoundEnabled(!soundEnabled)} className={`flex-1 flex flex-col items-center justify-center gap-1 py-3 rounded-2xl text-xs font-bold transition border ${soundEnabled ? `bg-gradient-to-br ${T.grad} border-transparent text-white` : 'bg-slate-800/50 border-white/10 text-slate-500'}`}>
                                            {soundEnabled ? <Volume2 size={20}/> : <VolumeX size={20}/>}
                                            <span>VOZ</span>
                                        </button>
                                        <button onClick={toggleMusic} className={`flex-1 flex flex-col items-center justify-center gap-1 py-3 rounded-2xl text-xs font-bold transition border ${musicEnabled ? 'bg-gradient-to-br from-pink-500 to-rose-500 border-transparent text-white' : 'bg-slate-800/50 border-white/10 text-slate-500'}`}>
                                            {musicEnabled ? <MusicNote size={20}/> : <MusicOff size={20}/>}
                                            <span>M√öSICA</span>
                                        </button>
                                    </div>
                                    
                                    <div className="relative pt-1">
                                        <input type="range" min="1000" max="15000" step="1000" value={16000 - gameSpeed} onChange={e=>setGameSpeed(16000 - Number(e.target.value))} 
                                            className={`w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-${theme === 'black' ? 'white' : 'blue-500'}`} 
                                        />
                                        <div className="flex justify-between text-[10px] font-bold text-slate-500 mt-2 uppercase tracking-wide">
                                            <span>Lento</span>
                                            <span>Velocidad</span>
                                            <span>R√°pido</span>
                                        </div>
                                    </div>

                                    <div className="flex justify-center mt-6 opacity-30 hover:opacity-100 transition">
                                        <span className="text-[10px] font-mono text-white bg-white/10 px-2 py-1 rounded-full">{APP_VERSION}</span>
                                    </div>
                                </div>
                            </div>

                            {/* PANEL DERECHO: TABLERO */}
                            <div className="lg:col-span-8 bg-slate-800/40 backdrop-blur-xl p-6 sm:p-8 rounded-[2rem] shadow-2xl border border-white/5">
                                <div className="grid grid-cols-10 gap-2 sm:gap-3">
                                    {Array.from({length:90},(_,i)=>i+1).map(n => {
                                        const active = drawnNumbers.includes(n);
                                        const curr = currentNumber===n;
                                        const color = getBallColor(n);
                                        
                                        return (
                                            <div key={n} 
                                                className={`aspect-square flex items-center justify-center rounded-xl font-bold text-sm sm:text-lg transition-all duration-500 relative
                                                ${curr 
                                                    ? 'z-20 scale-125 text-white neon-box bg-slate-900 border-2' 
                                                    : active 
                                                        ? 'bg-slate-700/80 text-white shadow-inner border border-white/10' 
                                                        : 'bg-slate-800/30 text-slate-600 border border-transparent'
                                                }`}
                                                style={curr ? {'--glow-color': color} : {}}
                                            >
                                                {/* Punto de luz si est√° activo */}
                                                {active && !curr && (
                                                    <div className="absolute w-1.5 h-1.5 rounded-full top-1.5 right-1.5 opacity-80" style={{background: color}}></div>
                                                )}
                                                <span className={curr ? 'neon-text' : ''} style={active ? {color: curr ? 'white' : color} : {}}>{n}</span>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>

                        {/* MODALES CON DISE√ëO FASHION */}
                        {/* Modal Cartones */}
                        {showTools && <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 transition-opacity">
                            <div className="bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col border border-white/10">
                                <div className="p-6 border-b border-white/5 flex justify-between items-center bg-white/5">
                                    <h2 className={`font-black text-xl flex gap-3 items-center ${T.accent}`}><FileText/> GESTI√ìN DE CARTONES</h2>
                                    <button onClick={()=>setShowTools(false)} className="w-8 h-8 flex items-center justify-center rounded-full bg-white/5 hover:bg-white/20 transition"><X size={18}/></button>
                                </div>
                                <div className="flex border-b border-white/5 p-1 bg-black/20">
                                    <button onClick={()=>setToolTab('check')} className={`flex-1 py-3 rounded-xl text-sm font-bold transition ${toolTab==='check'? `bg-white/10 text-white shadow` : 'text-slate-500 hover:text-slate-300'}`}>Verificar</button>
                                    <button onClick={()=>setToolTab('print')} className={`flex-1 py-3 rounded-xl text-sm font-bold transition ${toolTab==='print'? `bg-white/10 text-white shadow` : 'text-slate-500 hover:text-slate-300'}`}>Imprimir</button>
                                </div>
                                <div className="p-8 overflow-y-auto">
                                    {toolTab==='check' && <div className="space-y-6">
                                        <div className="flex gap-3">
                                            <input type="number" placeholder="N¬∫ Serie" className="flex-1 bg-black/30 border border-white/10 text-white p-4 rounded-xl focus:border-blue-500 focus:outline-none text-lg font-mono tracking-widest" value={checkSerial} onChange={e=>setCheckSerial(e.target.value)}/>
                                            <button onClick={handleCheckCard} className={`bg-gradient-to-r ${T.grad} text-white px-8 rounded-xl font-bold shadow-lg hover:brightness-110 active:scale-95 transition`}>Verificar</button>
                                        </div>
                                        {checkResult && <div className="bg-white/5 p-6 rounded-2xl border border-white/10">
                                            <div className="flex justify-between mb-4 items-center">
                                                <span className="font-bold text-white text-lg">Cart√≥n <span className="text-blue-400 font-mono">#{checkResult.s}</span></span>
                                                <span className={`px-4 py-1 rounded-full text-xs font-black uppercase tracking-wider ${checkResult.analysis.mainPrize.includes('!') ? 'bg-gradient-to-r from-yellow-400 to-orange-500 text-black shadow-lg shadow-orange-500/20' : 'bg-slate-700 text-slate-400'}`}>{checkResult.analysis.mainPrize}</span>
                                            </div>
                                            <div className="space-y-2">
                                                {checkResult.grid.map((r,i)=>
                                                    <div key={i} className="grid grid-cols-9 gap-1">
                                                        {r.map((n,j)=><div key={j} className={`h-10 flex items-center justify-center text-sm font-bold rounded-lg transition ${n===0?'bg-transparent':drawnNumbers.includes(n)?'bg-green-500 text-white shadow-lg shadow-green-500/30 scale-105':'bg-white/10 text-white/50 border border-white/5'}`}>{n||''}</div>)}
                                                    </div>
                                                )}
                                            </div>
                                        </div>}
                                    </div>}
                                    {toolTab==='print' && <div className="space-y-6">
                                        <div className="grid grid-cols-2 gap-6">
                                            <div>
                                                <label className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 block">Serie Inicial</label>
                                                <input type="number" className="w-full bg-black/30 border border-white/10 text-white p-4 rounded-xl focus:border-blue-500 focus:outline-none" value={printSerialStart} onChange={e=>setPrintSerialStart(e.target.value)}/>
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 block">Cantidad</label>
                                                <input type="number" className="w-full bg-black/30 border border-white/10 text-white p-4 rounded-xl focus:border-blue-500 focus:outline-none" value={printCount} onChange={e=>setPrintCount(e.target.value)}/>
                                            </div>
                                        </div>
                                        <div className="pt-4 flex flex-col gap-3">
                                            <button onClick={handlePrint} className="w-full bg-slate-700 hover:bg-slate-600 text-white py-4 rounded-xl font-bold border border-white/5 transition">1. Generar Vista Previa</button>
                                            {generatedCards.length>0 && <button onClick={openPrintWindow} className="w-full bg-gradient-to-r from-emerald-500 to-green-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-emerald-900/20 hover:brightness-110 active:scale-95 transition animate-bounce-short">2. Descargar PDF</button>}
                                        </div>
                                    </div>}
                                </div>
                            </div>
                        </div>}

                        {/* Modal Configuraci√≥n & Magic (STEALTH) */}
                        {showMagic && <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-50 flex items-center justify-center p-4">
                            <div className="bg-slate-900 w-full max-w-sm rounded-3xl shadow-2xl p-8 border border-white/10">
                                <div className="flex justify-between items-center mb-8">
                                    <h2 onClick={() => setMagicClicks(c => c + 1)} className="font-black text-xl flex items-center gap-3 text-white cursor-pointer select-none tracking-wide">
                                        <Settings className="text-slate-500"/> AJUSTES
                                    </h2>
                                    <button onClick={() => { setShowMagic(false); setMagicClicks(0); setIsMagicAuthenticated(false); setMagicCode(""); }} className="w-8 h-8 flex items-center justify-center rounded-full bg-white/5 text-slate-400 hover:bg-white/20 hover:text-white transition"><X size={18}/></button>
                                </div>

                                <div className="mb-8">
                                    <h3 className="text-[10px] font-bold text-slate-500 uppercase mb-4 flex items-center gap-2 tracking-widest"><Palette size={12}/> Estilo Visual</h3>
                                    <div className="flex justify-between gap-2 p-2 bg-black/20 rounded-2xl border border-white/5">
                                        {Object.entries(THEMES).map(([key, t]) => (
                                            <button 
                                                key={key}
                                                onClick={() => setTheme(key)}
                                                className={`w-8 h-8 rounded-full bg-gradient-to-br ${t.grad} transition-all duration-300 ${theme === key ? 'scale-110 ring-2 ring-white ring-offset-2 ring-offset-slate-900' : 'opacity-50 hover:opacity-100 hover:scale-105'}`}
                                                title={t.name}
                                            />
                                        ))}
                                    </div>
                                </div>

                                {(magicClicks >= 5 || isMagicAuthenticated) && (
                                    <div className="animate-bounce-short">
                                        <div className="w-full h-px bg-white/10 my-6"></div>
                                        
                                        {!isMagicAuthenticated ? (
                                            <div className="space-y-4">
                                                <input 
                                                    type="password" 
                                                    className="w-full bg-black/40 border border-white/10 text-white p-4 rounded-xl text-center tracking-[0.5em] text-lg focus:border-purple-500 focus:outline-none transition" 
                                                    placeholder="¬∑¬∑¬∑¬∑"
                                                    value={magicCode}
                                                    onChange={(e) => setMagicCode(e.target.value)}
                                                />
                                                <button onClick={handleMagicLogin} className="w-full bg-white text-black py-3 rounded-xl font-black hover:bg-slate-200 transition">DESBLOQUEAR</button>
                                            </div>
                                        ) : (
                                            <div className="space-y-6">
                                                <div className="bg-purple-900/20 border border-purple-500/30 p-5 rounded-2xl relative overflow-hidden">
                                                    <div className="absolute top-0 right-0 w-20 h-20 bg-purple-500/20 blur-2xl rounded-full"></div>
                                                    
                                                    <div className="flex items-center gap-2 text-purple-400 font-black mb-1 relative z-10">
                                                        <Wand2 size={18}/> MAGIC MODE
                                                    </div>
                                                    <p className="text-xs text-purple-300/60 mb-4 relative z-10">Algoritmo de probabilidad aumentada.</p>
                                                    
                                                    <div className="mb-4 relative z-10">
                                                        <label className="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block">Serial Objetivo</label>
                                                        <input 
                                                            type="number" 
                                                            className="w-full bg-black/40 border border-white/10 text-white p-3 rounded-xl focus:border-purple-500 focus:outline-none font-mono" 
                                                            placeholder="0000"
                                                            value={magicSerial}
                                                            onChange={(e) => setMagicSerial(e.target.value)}
                                                        />
                                                    </div>

                                                    <div className="flex items-center gap-3 relative z-10">
                                                        <span className="text-xs font-bold text-slate-300 flex-1">Estado del Sistema</span>
                                                        <button 
                                                            onClick={() => setMagicEnabled(!magicEnabled)}
                                                            className={`w-14 h-7 rounded-full p-1 transition-all duration-300 ${magicEnabled ? 'bg-purple-500 shadow-[0_0_10px_#a855f7]' : 'bg-slate-700'}`}
                                                        >
                                                            <div className={`bg-white w-5 h-5 rounded-full shadow-sm transform transition-transform duration-300 ${magicEnabled ? 'translate-x-7' : ''}`}></div>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>}

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BingoApp />);
    </script>
</body>
</html>